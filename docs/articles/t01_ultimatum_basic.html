<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1. Introduction: A Simple Ultimatum Game â€¢ gtree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="1. Introduction: A Simple Ultimatum Game">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gtree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/t01_ultimatum_basic.html">1. Introduction: A Simple Ultimatum Game</a>
    </li>
    <li>
      <a href="../articles/t02_ultimatum_imperfect.html">2. Moves of Nature and Imperfect Information</a>
    </li>
    <li>
      <a href="../articles/t03_kuhn_poker.html">3. Kuhn Poker</a>
    </li>
    <li>
      <a href="../articles/t04_sender_receiver.html">4. Comparing with Gambit Python API: QRE in a Sender-Receriver Game</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/skranz/gtree">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>1. Introduction: A Simple Ultimatum Game</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skranz/gtree/blob/master/vignettes/t01_ultimatum_basic.Rmd"><code>vignettes/t01_ultimatum_basic.Rmd</code></a></small>
      <div class="hidden name"><code>t01_ultimatum_basic.Rmd</code></div>

    </div>

    
    
<p>This tutorial uses an even simpler ultimatum game example than the README file. Yet, we explain <code>gtree</code> in a bit more detail.</p>
<div id="specifying-the-game" class="section level2">
<h2 class="hasAnchor">
<a href="#specifying-the-game" class="anchor"></a>Specifying the game</h2>
<p>First, we load the <code>gtree</code> library amd then define a simple ultimatum game with the function <code>new_game</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gtree)</a>
<a class="sourceLine" id="cb1-2" title="2">game =<span class="st"> </span><span class="kw"><a href="../reference/new_game.html">new_game</a></span>(</a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="dt">gameId =</span> <span class="st">"UltimatumGame"</span>,</a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="dt">options =</span> <span class="kw"><a href="../reference/make_game_options.html">make_game_options</a></span>(<span class="dt">verbose=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="dt">params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">numPlayers=</span><span class="dv">2</span>,<span class="dt">cake=</span><span class="dv">4</span>),</a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="dt">stages =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb1-7" title="7">    <span class="kw"><a href="../reference/stage.html">stage</a></span>(<span class="st">"proposerStage"</span>,</a>
<a class="sourceLine" id="cb1-8" title="8">      <span class="dt">player=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1-9" title="9">      <span class="dt">actions =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb1-10" title="10">        <span class="kw"><a href="../reference/action.html">action</a></span>(<span class="st">"offer"</span>,<span class="op">~</span><span class="dv">0</span><span class="op">:</span>cake)</a>
<a class="sourceLine" id="cb1-11" title="11">      )</a>
<a class="sourceLine" id="cb1-12" title="12">    ),</a>
<a class="sourceLine" id="cb1-13" title="13">    <span class="kw"><a href="../reference/stage.html">stage</a></span>(<span class="st">"responderStage"</span>,</a>
<a class="sourceLine" id="cb1-14" title="14">      <span class="dt">player=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1-15" title="15">      <span class="dt">observe =</span> <span class="st">"offer"</span>,</a>
<a class="sourceLine" id="cb1-16" title="16">      <span class="dt">actions =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb1-17" title="17">        <span class="kw"><a href="../reference/action.html">action</a></span>(<span class="st">"accept"</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="ot">FALSE</span>,<span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-18" title="18">      )</a>
<a class="sourceLine" id="cb1-19" title="19">    ),</a>
<a class="sourceLine" id="cb1-20" title="20">    <span class="kw"><a href="../reference/stage.html">stage</a></span>(<span class="st">"PayoffStage"</span>,</a>
<a class="sourceLine" id="cb1-21" title="21">      <span class="dt">player=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1-22" title="22">      <span class="dt">compute=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb1-23" title="23">        payoff_<span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(accept, cake<span class="op">-</span>offer,<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1-24" title="24">        payoff_<span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(accept, offer,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-25" title="25">      )</a>
<a class="sourceLine" id="cb1-26" title="26">    )</a>
<a class="sourceLine" id="cb1-27" title="27">  )</a>
<a class="sourceLine" id="cb1-28" title="28">)</a></code></pre></div>
<p>The <code>gameId</code> should be a unique name of the game. This is relevant if we want to conveniently save results, like computed equilibria, in the default folder structure used by <code>gtree</code>.</p>
<p>We then define a list of parameters <code>params</code>. Parameters can be referenced to in later definitions of the game. Note that you must <em>always</em> specify the number of players in a parameter called <code>numPlayers</code>. We also specify the size of the <code>cake</code> that can be distributed between the proposer and responder in the game.</p>
<p>Heart of our definition is a list of 3 <code>stages</code>. Each stage in the list should be generated with the function <code>stage</code> that sets defaults and transforms all formulas into a canoncial format.</p>
<p>1. In the first stage is named <code>proposerStage</code>. The argument <code>player=1</code>, specifies that player 1 acts here. She chooses an action <code>offer</code>, that is created with the function <code>action</code> and element of a list <code>actions</code>. The function <code>action</code> first requires a name and then a set of possible values the action can take. Here we specify the set as a formula <code>~ 0:cake</code>. This means we compute the action set based on the specified parameters and possibly based on previously computed variables including chosen action values or realized moves of nature.<br> Alternatively, we could also provide a fixed action set without formula e.q. <code>0:4</code>. This can not contain references to parameters or variables of the game and is always fixed when the game is created.</p>
<p>2. In the second stage player 2, observes the offer. This is specified by the argument <code>observe="offer"</code>. The argument observe specifies all observed variables as a simple character vector, or remains <code>NULL</code> if nothing is observed.<br> Player 2 then decides whether to accept the action or not. Here we have chosen the fixed action set <code><a href="https://www.rdocumentation.org/packages/base/topics/c">c(FALSE,TRUE)</a></code>. You could encode specify the set for accept in a different way, e.g.Â as a character vector <code><a href="https://www.rdocumentation.org/packages/base/topics/c">c("reject","accept")</a></code> or an integer vector <code><a href="https://www.rdocumentation.org/packages/base/topics/c">c(0,1)</a></code>.</p>
<p>3. The third stage just computes variables as specified by the list provided for the field <code>compute</code>. You can briefly specify a computation with the formula syntax <code>name ~ formula</code>. Note that for each player <code>i</code> you must compute somewhere in your game the variable <code>payoff_i</code>, like <code>payoff_1</code> and <code>payoff_2</code>, that specifies the (monetary) payoff for that player. We can later easily transform these monetary payoffs, using some alternative outcome based utility function, e.g.Â to account for inequality aversion or loss aversion. <br>You can use any vectorized, deterministic R function to specify a computed variable. Random variables must be declared separately, as a move of nature, however (see further below). Here we use the function <code>ifelse</code> for a simple distinction of two cases. For distinguishing more than two cases the functions <code>cases</code> in <code>gtree</code> provides a simple syntax. Note that we could have more compactly written: <code>payoff_1 ~ (cake-offer)*accept</code> and <code>payoff_2 ~ offer*accept</code></p>
<p>For computing equilibria, it does not really matter which players you specify a stage in which no action takes place. However, <code>gtree</code> also has (currently rudimentary) features to run a game as a web-based experiment. When running as an experiment, a stage will be shown to all players that are specified in the <code>players</code> field. If an action is taken in a stage, exactly ONE player must be specified. For stages without actions, you can specify any number of players including no player.</p>
<p>We can get a short overview of a specified game by typing its variable name in the R console.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">game</a></code></pre></div>
<pre><code>## 
## UltimatumGame
## 
## Parameters: numPlayers=2, cake=4
## 
## proposerStage
##   Player: 1
##   Action offer &lt;U+2208&gt; 0:cake
## 
## responderStage
##   Player: 2
##   Observe: offer
##   Action accept &lt;U+2208&gt; {FALSE, TRUE}
## 
## PayoffStage
##   Player: 1, 2
##   Compute payoff_1 = ifelse(accept, cake - offer, 0)
##   Compute payoff_2 = ifelse(accept, offer, 0)</code></pre>
</div>
<div id="compiling-and-solving-for-equilibria" class="section level2">
<h2 class="hasAnchor">
<a href="#compiling-and-solving-for-equilibria" class="anchor"></a>Compiling and Solving for equilibria</h2>
<p>In order to compute equlibria <code>gtree</code> will create different internal representations of the game. While the function <code>game_solve</code> will automatically call the corresponding functions, it is useful to call them manually before.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/game_compile.html">game_compile</a></span>(game, <span class="dt">for.internal.solver =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## 
## Compute game tree for UltimatumGame variant ...
## Gametree for UltimatumGame: Add stage proposerStage (1 outcomes so far) ...
## Gametree for UltimatumGame: Add stage responderStage (5 outcomes so far) ...
## Gametree for UltimatumGame: Add stage PayoffStage (10 outcomes so far) ...
## Game tree for UltimatumGame: All stages parsed (10 outcomes), finalize outcomes and et.mat...
## Game tree for UltimatumGame: All stages parsed (10 outcomes), compute info sets...
## Game tree for UltimatumGame: All stages parsed (10 outcomes), compute subgames...
## Game tree for UltimatumGame: All stages parsed (10 outcomes), compute spi...
## Game tree for UltimatumGame: All stages parsed (10 outcomes), compute spo table...
## Game tree for UltimatumGame: completely generated.</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">game</a></code></pre></div>
<pre><code>## 
## UltimatumGame
## 
## Parameters: numPlayers=2, cake=4
## 
## proposerStage
##   Player: 1
##   Action offer &lt;U+2208&gt; 0:cake
## 
## responderStage
##   Player: 2
##   Observe: offer
##   Action accept &lt;U+2208&gt; {FALSE, TRUE}
## 
## PayoffStage
##   Player: 1, 2
##   Compute payoff_1 = ifelse(accept, cake - offer, 0)
##   Compute payoff_2 = ifelse(accept, offer, 0)
## 
## 
## Size Information:
##   - 10 possible outcomes
##   - 6 information sets (1 + 5)
##   - 160 pure strategy profiles (5 * 32)
##   - 6 subgames
##   - 15 relevant pure strategy profiles in subgames</code></pre>
<p>We now see some additional information about the size of the game in terms of number of outcomes, information sets, subgames and number of pure strategy profiles.</p>
<p>As a game tree our game looks as follows: <img src="ug.svg" alt="ug.svg"></p>
<p>Remark 1: By default <code>game_compile</code> only computes the information neccessary to create a game tree that can be saved as a Gambit <code>.efg</code> file and then solved via Gambit. Gambit has a larger selection of solvers and for many cases, you have to use Gambit. E.g. when finding a mixed strategy equilibrium. Only for finding all pure strategy SPE, <code>gtree</code> has an internal solver (it is often faster than the corresponding <code>gambit-enumpure</code> solver of Gambit). The internal solver computes some additional information, e.g.Â identifying in which information sets new subgames start. The argument <code>for.internal.solver</code> forced the computation of this additional information.</p>
<p>Remark 2: A game object is an environment, this means functions like <code>game_compile</code> have side effects and directly change the game object. Nevertheless, all functions starting with <code>game_</code> also return the changed game object invisibly. They thus can be conveniently used with pipes.</p>
<p>Remark 3: To generate an image of the game tree, we can export the game to a <a href="http://www.gambit-project.org/">Gambit</a> extensive form game format using the following command:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="../reference/game_write_efg.html">game_write_efg</a></span>(game,<span class="st">"UG.efg"</span>)</a></code></pre></div>
<p>We can then open the file with Gambit GUI, which draws the game tree.</p>
<p>Ok, enough remarks. Let us now solve the game. More precisely, we use the internal solver to find all pure strategy subgame (SPE) perfect equilibria.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">game_solve</span>(game)</a></code></pre></div>
</div>
<div id="expected-equilibrium-outcomes" class="section level2">
<h2 class="hasAnchor">
<a href="#expected-equilibrium-outcomes" class="anchor"></a>Expected Equilibrium outcomes</h2>
<p>The following code shows the equilibrium outcomes, i.e.Â all actions and computed variables on the equilibrium path.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="../reference/eq_expected_outcomes.html">eq_expected_outcomes</a></span>(game)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   offer accept payoff_1 payoff_2 util_1 util_2 eqo.ind
##   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;int&gt;
## 1     1      1        3        1      3      1       1
## 2     0      1        4        0      4      0       2</code></pre>
<p>We have two different equilibrium outcomes: the proposer either offers 0 or 1 and in both equilibrium outcomes the offer will be accepted. For games with moves of nature there is also a function <code>eq_expected_outcomes</code> that shows expected equilibrium outcomes.</p>
</div>
<div id="equilibria-represented-as-action-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#equilibria-represented-as-action-tables" class="anchor"></a>Equilibria represented as action tables</h2>
<p>An equilibrium also describes equilibrium play off the equilibrium path, e.g.Â it also describes whether player 2 would <code>accept</code> an out-off-equilibrium <code>offer</code> of 3.</p>
<p>In gtree there are different ways to represent the computed equilibria. Here is a convenient representation for pure strategy equilibria:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="../reference/eq_tables.html">eq_tables</a></span>(game, <span class="dt">combine=</span><span class="dv">2</span>, <span class="dt">reduce.tables =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## $offer
## # A tibble: 2 x 2
##   offer eq.inds
##   &lt;int&gt; &lt;chr&gt;  
## 1     0 2      
## 2     1 1      
## 
## $accept
## # A tibble: 3 x 2
##   accept eq.inds
##   &lt;lgl&gt;  &lt;chr&gt;  
## 1 FALSE  1      
## 2 TRUE   2      
## 3 TRUE   1,2</code></pre>
<p>We have a list with a <code>tibble</code> for every action variable.</p>
<ul>
<li><p>The first table describes the equilibrium offers: In the first equilibrium the offer is 1 and in the 2nd it is 0.</p></li>
<li><p>The second table describes the conditional <code>accept</code> decisions: In the first equilibrium an offer of <code>0</code> is rejected, in all other cases the offer is accepted.</p></li>
</ul>
<p>The argument <code>combine</code> can take the values 0,1 and 2 and describes how the results of different equilibria are combined. For example, with <code>combine = 0</code>, we would get a separate list for every equilibrium. The argument <code>reduce.tables</code> automatically removes key columns that have no impact on the chosen equilibrium action.</p>
</div>
<div id="conditional-expected-equilibrium-outcomes" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-expected-equilibrium-outcomes" class="anchor"></a>Conditional expected equilibrium outcomes</h2>
<p>Let me illustrate another useful function to explore equilibria:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="../reference/eq_cond_expected_outcomes.html">eq_cond_expected_outcomes</a></span>(game, <span class="dt">offer=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 9
##   eq.ind offer accept payoff_1 payoff_2 util_1 util_2 is.eqo cond.ind
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;     &lt;int&gt;
## 1      1     0      0        0        0      0      0 FALSE         1
## 2      2     0      1        4        0      4      0 TRUE          1</code></pre>
<p>Here we show the expected conditional equilibrium outcomes (for all equilibria) assuming that player 1 chooses an offer of 0.</p>
<p>The column <code>is.eqo</code> is TRUE if <code>offer = 0</code> indeed could happen with positive probability on the equilibrium path of the corresponding equilibrium.</p>
<p>If that offer would not ever be chosen on the equilibrium path, think of the condition as an unexpected one-shot deviation from the equilbrium path.</p>
<p>We can study multiple conditions, e.g.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># Condition first on offer = 0 then on offer = 1</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw"><a href="../reference/eq_cond_expected_outcomes.html">eq_cond_expected_outcomes</a></span>(game, <span class="dt">offer=</span><span class="dv">0</span><span class="op">:</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 9
##   eq.ind offer accept payoff_1 payoff_2 util_1 util_2 is.eqo cond.ind
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;     &lt;int&gt;
## 1      1     0      0        0        0      0      0 FALSE         1
## 2      2     0      1        4        0      4      0 TRUE          1
## 3      1     1      1        3        1      3      1 TRUE          2</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># Condition step-by-step on each possible offer</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw"><a href="../reference/eq_cond_expected_outcomes.html">eq_cond_expected_outcomes</a></span>(game, <span class="st">"offer"</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##   eq.ind offer accept payoff_1 payoff_2 util_1 util_2 is.eqo cond.ind
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;     &lt;int&gt;
## 1      1     0      0        0        0      0      0 FALSE         1
## 2      2     0      1        4        0      4      0 TRUE          1
## 3      1     1      1        3        1      3      1 TRUE          2
## 4      1     2      1        2        2      2      2 FALSE         3
## 5      1     3      1        1        3      1      3 FALSE         4
## 6      1     4      1        0        4      0      4 FALSE         5</code></pre>
<p>We can also condition on different variables at the same time:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw"><a href="../reference/eq_cond_expected_outcomes.html">eq_cond_expected_outcomes</a></span>(game, <span class="dt">offer=</span><span class="dv">2</span>, <span class="dt">accept=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 9
##   eq.ind offer accept payoff_1 payoff_2 util_1 util_2 is.eqo cond.ind
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;     &lt;int&gt;
## 1      1     2      0        0        0      0      0 FALSE         1</code></pre>
<p>Here we assume that in the same play player 1 trembles to offer=2 and player 2 trembles to not accept.</p>
<p>Admittedly these functions are not really neccessary for our simple Ultimatum game. Yet, take a look at the the Kuhn-Poker tutorial to see how they help to illuminate more complicated equilibrium structures.</p>
</div>
<div id="internal-representation-of-equilibria" class="section level2">
<h2 class="hasAnchor">
<a href="#internal-representation-of-equilibria" class="anchor"></a>Internal representation of equilibria</h2>
<p>The different representations of equilibria are computed from an internal representation of equilibria. To understand the internal representation, it is first useful to show all possible outcomes of the game:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw"><a href="../reference/get_outcomes.html">get_outcomes</a></span>(game, <span class="dt">reduce.cols=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 6
##    offer accept payoff_1 payoff_2 util_1 util_2
##    &lt;int&gt; &lt;lgl&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1     0 FALSE         0        0      0      0
##  2     0 TRUE          4        0      4      0
##  3     1 FALSE         0        0      0      0
##  4     1 TRUE          3        1      3      1
##  5     2 FALSE         0        0      0      0
##  6     2 TRUE          2        2      2      2
##  7     3 FALSE         0        0      0      0
##  8     3 TRUE          1        3      1      3
##  9     4 FALSE         0        0      0      0
## 10     4 TRUE          0        4      0      4</code></pre>
<p>This data frame corresponds to all possible full paths that can be taken through the game tree. (It does not fully describe the game tree, though, since it contains no specification of information sets.)</p>
<p>Let us now show the internal representation of our 2 equilibria:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw"><a href="../reference/eq_li.html">eq_li</a></span>(game)</a></code></pre></div>
<pre><code>## [[1]]
##       offer accept .prob
##  [1,]     0      1     0
##  [2,]     0      0     0
##  [3,]     1      0     0
##  [4,]     1      1     1
##  [5,]     0      0     0
##  [6,]     0      1     0
##  [7,]     0      0     0
##  [8,]     0      1     0
##  [9,]     0      0     0
## [10,]     0      1     0
## attr(,"eq.ind")
## [1] 1
## attr(,"info.set.probs")
##  [1] 0 1 0 0 0 1 0 0 1 0 1 0 1 0 1
## 
## [[2]]
##       offer accept .prob
##  [1,]     1      0     0
##  [2,]     1      1     1
##  [3,]     0      0     0
##  [4,]     0      1     0
##  [5,]     0      0     0
##  [6,]     0      1     0
##  [7,]     0      0     0
##  [8,]     0      1     0
##  [9,]     0      0     0
## [10,]     0      1     0
## attr(,"eq.ind")
## [1] 2
## attr(,"info.set.probs")
##  [1] 1 0 0 0 0 0 1 0 1 0 1 0 1 0 1
## 
## attr(,"solve.time")
## Time difference of 0.342927 secs</code></pre>
<p>It is a list with a matrix for each equilibrium. Each row corresponds to one possible outcome of the game and the column describe for each action the equilibrium choice probability on the corresponding outcome path. The last column specifies the total probality of the particular outcome in the equilibrium.</p>
<p>The attribute <code>info.set.probs</code> shows the most compact equilibrium representation. It is just a numerical vector that describes the move probability for every possible move in every information set. This is similar to the equilibrium representation that you get if you manually call a Gambit solver on an <code>.efg</code> file (except that Gambit has a different default ordering of the information sets). The information sets are further described in the <code>game</code> object. In principle you can access the information, e.g.Â by typing</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">game<span class="op">$</span>tg<span class="op">$</span>ise.df</a></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##   .info.set.ind .info.set  .player .var   .num.moves .num.nodes .lev.num
##           &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;       &lt;int&gt;      &lt;int&gt;    &lt;int&gt;
## 1             1 1_offer_1        1 offer           5          1        1
## 2             2 2_accept_1       2 accept          2          1        2
## 3             3 2_accept_2       2 accept          2          1        2
## 4             4 2_accept_3       2 accept          2          1        2
## 5             5 2_accept_4       2 accept          2          1        2
## 6             6 2_accept_5       2 accept          2          1        2
## # ... with 2 more variables: .info.set.move.ind.start &lt;dbl&gt;,
## #   .move.vals &lt;list&gt;</code></pre>
<p>Yet, there should not be any need to dig so deeply into the internal game representation of <code>gtree</code>.</p>
</div>
<div id="setting-different-preferences" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-different-preferences" class="anchor"></a>Setting different preferences</h2>
<p>So far we assumed that the specified payoffs <code>payoff_1</code> and <code>payoff_2</code> are equal to playersâ€™ utility. One motivation for gtree is to conveniently solve games for different specifications of playersâ€™ preferences that can account e.g.Â for inequality aversion or loss aversion.</p>
<p>While in principle, one could account for different outcome based preferences by directly adapting the formulas for <code>payoff_1</code> and <code>payoff_2</code> in the game definition, we prefer a slightly different approach.</p>
<p>In the preferred approach the specified payoffs in the game definition are interpreted as monetary or material payoffs. This means games created by <code>new_game</code> can very closely match the structure of economic experiments, for which we only know the specified monetary payoffs.</p>
<p>After the game is specified, we can use the function <code>game_set_preferences</code> to specify a utility function for which we want to find equilibria.</p>
<p>For example, consider the following inequality aversion utility function (Fehr and Schmidt, 1999) <span class="math display">\[
u_i = \pi_i 
  - \alpha \frac {1}{n-1}\sum_{j \ne i} \max(\pi_j - \pi_i,0)
  + \beta \frac {1}{n-1}\sum_{j \ne i} \max(\pi_i - \pi_j,0)
\]</span> where <span class="math inline">\(\pi\)</span> denotes monetary payoffs.</p>
<p>The following code manually specifies these preferences and solves for subgame perfect equilibria:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">pref =<span class="st"> </span><span class="kw"><a href="../reference/pref_custom.html">pref_custom</a></span>(</a>
<a class="sourceLine" id="cb28-2" title="2">  <span class="dt">util_1 =</span> payoff_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">*</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">pmax</a></span>(payoff_<span class="dv">2</span><span class="op">-</span>payoff_<span class="dv">1</span>,<span class="dv">0</span>)) <span class="op">-</span><span class="st"> </span>beta<span class="op">*</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">pmax</a></span>(payoff_<span class="dv">1</span><span class="op">-</span>payoff_<span class="dv">2</span>,<span class="dv">0</span>)),</a>
<a class="sourceLine" id="cb28-3" title="3">  <span class="dt">util_2 =</span> payoff_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">*</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">pmax</a></span>(payoff_<span class="dv">1</span><span class="op">-</span>payoff_<span class="dv">2</span>,<span class="dv">0</span>)) <span class="op">-</span><span class="st"> </span>beta<span class="op">*</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">pmax</a></span>(payoff_<span class="dv">1</span><span class="op">-</span>payoff_<span class="dv">2</span>,<span class="dv">0</span>)),</a>
<a class="sourceLine" id="cb28-4" title="4">  <span class="dt">params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">beta=</span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb28-5" title="5">  <span class="dt">label =</span> <span class="st">"ineqAv_100_50"</span></a>
<a class="sourceLine" id="cb28-6" title="6">)</a>
<a class="sourceLine" id="cb28-7" title="7"></a>
<a class="sourceLine" id="cb28-8" title="8">game <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/game_set_preferences.html">game_set_preferences</a></span>(pref) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="st">  </span><span class="kw"><a href="../reference/game_solve_spe.html">game_solve_spe</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="st">  </span><span class="kw"><a href="../reference/eq_tables.html">eq_tables</a></span>()</a></code></pre></div>
<pre><code>## $offer
## # A tibble: 1 x 2
##   offer eq.inds
##   &lt;int&gt; &lt;chr&gt;  
## 1     2 1      
## 
## $accept
## # A tibble: 5 x 3
## # Groups:   offer [5]
##   offer accept eq.inds
##   &lt;int&gt; &lt;lgl&gt;  &lt;chr&gt;  
## 1     0 FALSE  1      
## 2     1 FALSE  1      
## 3     2 TRUE   1      
## 4     3 TRUE   1      
## 5     4 TRUE   1</code></pre>
<p>We see that with inequality aversion with an envy parameter of <code>alpha=1</code> and a guilt parameter of <code>beta=0.5</code> there is a unique SPE in which the proposer offers half of the cake.</p>
<p>Some common preference clases that are only transformations of material payoffs are included into gtree. All functions start with the prefix <code>pref_</code>. The following code verifies that guilt is not essential for positive offers by the proposer.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">game <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/game_set_preferences.html">game_set_preferences</a></span>(<span class="kw"><a href="../reference/pref_ineqAv.html">pref_ineqAv</a></span>(<span class="dt">alpha=</span><span class="dv">1</span>,<span class="dt">beta=</span><span class="dv">0</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="st">  </span><span class="kw">game_solve</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/eq_tables.html">eq_tables</a></span>()</a></code></pre></div>
<pre><code>## $offer
## # A tibble: 1 x 2
##   offer eq.inds
##   &lt;int&gt; &lt;chr&gt;  
## 1     2 1      
## 
## $accept
## # A tibble: 5 x 3
## # Groups:   offer [5]
##   offer accept eq.inds
##   &lt;int&gt; &lt;lgl&gt;  &lt;chr&gt;  
## 1     0 FALSE  1      
## 2     1 FALSE  1      
## 3     2 TRUE   1      
## 4     3 TRUE   1      
## 5     4 TRUE   1</code></pre>
<p>We will discuss later how one can specify heterogenous preferences via different preference types.</p>
</div>
<div id="finding-a-logit-quantal-response-equilibrium-using-gambit" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-a-logit-quantal-response-equilibrium-using-gambit" class="anchor"></a>Finding a logit quantal response equilibrium using Gambit</h2>
<p>The internal <code>gtree</code> solver can only find pure strategy subgame perfect equilibria. To effectively use <code>gtree</code> you should also install <a href="http://www.gambit-project.org/">Gambit</a> on your computer. Then best add the Gambit directory to your system PATH. Otherwise adapt the following call to globably specify the gambit directory:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">gtree.gambit.dir=</span><span class="st">"C:/your/gambit/path"</span>)</a></code></pre></div>
<p>The following code uses the <a href="https://gambitproject.readthedocs.io/en/latest/tools.html#gambit-logit-compute-quantal-response-equilbria">gambit-logit</a> command line solver to find a <a href="https://en.wikipedia.org/wiki/Quantal_response_equilibrium">logit quantal response equilibrium</a> using a parameter <code>lambda = 2</code> assuming inequality aversion preferences.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">game <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/game_set_preferences.html">game_set_preferences</a></span>(<span class="kw"><a href="../reference/pref_ineqAv.html">pref_ineqAv</a></span>(<span class="dt">alpha=</span><span class="dv">1</span>,<span class="dt">beta=</span><span class="fl">0.5</span>, <span class="dt">player=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/game_gambit_solve.html">game_gambit_solve</a></span>(<span class="dt">qre.lambda=</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/eq_tables.html">eq_tables</a></span>()</a></code></pre></div>
<pre><code>## 
## Written to C:\Users\skranz\AppData\Local\Temp\RtmpiQtdyA/UltimatumGame___ineq100_50.efg
## 
## Solve with command gambit-logit -q -e -m 2 ... done in 0.3220451 secs</code></pre>
<pre><code>## $offer
## # A tibble: 5 x 3
## # Groups:   offer [5]
##   offer      .prob eq.inds
##   &lt;int&gt;      &lt;dbl&gt; &lt;chr&gt;  
## 1     0 0.0165     1      
## 2     1 0.0263     1      
## 3     2 0.955      1      
## 4     3 0.00217    1      
## 5     4 0.00000495 1      
## 
## $accept
## # A tibble: 10 x 4
## # Groups:   offer, accept [10]
##    offer accept    .prob eq.inds
##    &lt;int&gt; &lt;lgl&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1     0 FALSE  1.000    1      
##  2     0 TRUE   0.000262 1      
##  3     1 FALSE  0.887    1      
##  4     1 TRUE   0.113    1      
##  5     2 FALSE  0.0159   1      
##  6     2 TRUE   0.984    1      
##  7     3 FALSE  0.0159   1      
##  8     3 TRUE   0.984    1      
##  9     4 FALSE  0.0159   1      
## 10     4 TRUE   0.984    1</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#specifying-the-game">Specifying the game</a></li>
      <li><a href="#compiling-and-solving-for-equilibria">Compiling and Solving for equilibria</a></li>
      <li><a href="#expected-equilibrium-outcomes">Expected Equilibrium outcomes</a></li>
      <li><a href="#equilibria-represented-as-action-tables">Equilibria represented as action tables</a></li>
      <li><a href="#conditional-expected-equilibrium-outcomes">Conditional expected equilibrium outcomes</a></li>
      <li><a href="#internal-representation-of-equilibria">Internal representation of equilibria</a></li>
      <li><a href="#setting-different-preferences">Setting different preferences</a></li>
      <li><a href="#finding-a-logit-quantal-response-equilibrium-using-gambit">Finding a logit quantal response equilibrium using Gambit</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sebastian Kranz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  


<script type="text/javascript">
var sc_project=12033707;
var sc_invisible=1;
var sc_security="71a49792";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/12033707/0/71a49792/1/"
alt="Web Analytics"></a></div></noscript>
  
  </body>
</html>
